<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>resoluciones</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Resoluciones_files/libs/clipboard/clipboard.min.js"></script>
<script src="Resoluciones_files/libs/quarto-html/quarto.js"></script>
<script src="Resoluciones_files/libs/quarto-html/popper.min.js"></script>
<script src="Resoluciones_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Resoluciones_files/libs/quarto-html/anchor.min.js"></script>
<link href="Resoluciones_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Resoluciones_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Resoluciones_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Resoluciones_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Resoluciones_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#problema-1" id="toc-problema-1" class="nav-link active" data-scroll-target="#problema-1">Problema 1</a>
  <ul class="collapse">
  <li><a href="#resolución" id="toc-resolución" class="nav-link" data-scroll-target="#resolución">Resolución</a></li>
  <li><a href="#conclusión" id="toc-conclusión" class="nav-link" data-scroll-target="#conclusión">Conclusión</a></li>
  </ul></li>
  <li><a href="#problema-2-restaurante-italiano-y-elección-del-menú" id="toc-problema-2-restaurante-italiano-y-elección-del-menú" class="nav-link" data-scroll-target="#problema-2-restaurante-italiano-y-elección-del-menú">Problema 2 – Restaurante italiano y elección del menú</a>
  <ul class="collapse">
  <li><a href="#resolución-1" id="toc-resolución-1" class="nav-link" data-scroll-target="#resolución-1">Resolución</a></li>
  <li><a href="#conclusión-1" id="toc-conclusión-1" class="nav-link" data-scroll-target="#conclusión-1">Conclusión</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Otros formatos</h2><ul><li><a href="Resoluciones.pdf"><i class="bi bi-file-pdf"></i>Typst</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">resoluciones</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="problema-1" class="level2">
<h2 class="anchored" data-anchor-id="problema-1">Problema 1</h2>
<p>Aplicar los criterios de decisión bajo incertidumbre a el problema cuya tabla de decisión es la siguiente:</p>
<p><strong>favorable</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>E1</th>
<th>E2</th>
<th>E3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>D1</td>
<td>90</td>
<td>45</td>
<td>-10</td>
</tr>
<tr class="even">
<td>D2</td>
<td>70</td>
<td>55</td>
<td>15</td>
</tr>
<tr class="odd">
<td>D3</td>
<td>40</td>
<td>35</td>
<td>22</td>
</tr>
</tbody>
</table>
<p><strong>desfavorable</strong></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>E1</th>
<th>E2</th>
<th>E3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>D1</td>
<td>-90</td>
<td>-45</td>
<td>10</td>
</tr>
<tr class="even">
<td>D2</td>
<td>-70</td>
<td>-55</td>
<td>-15</td>
</tr>
<tr class="odd">
<td>D3</td>
<td>-40</td>
<td>-35</td>
<td>-22</td>
</tr>
</tbody>
</table>
<p>resuelverlo con cada uno de los métodos o funciones individuales de incertidumbre por separado (tanto en situación favorable como desfavorable)</p>
<section id="resolución" class="level3">
<h3 class="anchored" data-anchor-id="resolución">Resolución</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"teoriadecision_funciones_incertidumbre.R"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="situación-favorable" class="level4">
<h4 class="anchored" data-anchor-id="situación-favorable">Situación favorable</h4>
<p>Definimos la tabla de decision</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tb01a<span class="ot">=</span><span class="fu">crea.tablaX</span>(<span class="fu">c</span>(<span class="dv">90</span>, <span class="dv">45</span>, <span class="sc">-</span><span class="dv">10</span>,<span class="dv">70</span>, <span class="dv">55</span>, <span class="dv">15</span>,<span class="dv">40</span>, <span class="dv">35</span>, <span class="dv">22</span>),<span class="at">numalternativas =</span> <span class="dv">3</span>,<span class="at">numestados =</span> <span class="dv">3</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tb01a</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   e1 e2  e3
d1 90 45 -10
d2 70 55  15
d3 40 35  22</code></pre>
</div>
</div>
<p>Aplico los métodos de incertidumbre</p>
<p>1) CRITERIO DE WALD</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Wald</span>(tb01a, <span class="at">favorable =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Wald"

$metodo
[1] "favorable"

$tablaX
   e1 e2  e3
d1 90 45 -10
d2 70 55  15
d3 40 35  22

$ValorAlternativas
 d1  d2  d3 
-10  15  22 

$ValorOptimo
[1] 22

$AlternativaOptima
d3 
 3 </code></pre>
</div>
</div>
<p>La alternativa 3 es la mejor según el criterio de Wald.</p>
<p>CRITERIO OPTIMISTA</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Optimista</span>(tb01a, <span class="at">favorable =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Optimista"

$metodo
[1] "favorable"

$tablaX
   e1 e2  e3
d1 90 45 -10
d2 70 55  15
d3 40 35  22

$ValorAlternativas
d1 d2 d3 
90 70 40 

$ValorOptimo
[1] 90

$AlternativaOptima
d1 
 1 </code></pre>
</div>
</div>
<p>La alternativa 1 es la mejor según el criterio optimista.</p>
<p>CRITERIO DE HURWICZ</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dibuja.criterio.Hurwicz</span>(tb01a, <span class="at">favorable =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Resoluciones_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dibuja.criterio.Hurwicz_Intervalos</span>(tb01a, <span class="at">favorable =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Resoluciones_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$AltOptimas
[1] 3 2 1

$PuntosDeCorte
[1] 0.189 0.556

$IntervalosAlfa
           Intervalo           Alternativa
Soluciones "( 0 , 0.189 )"     "3"        
           "( 0.189 , 0.556 )" "2"        
           "( 0.556 , 1 )"     "1"        </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Hurwicz</span>(tb01a, <span class="at">alfa =</span> <span class="dv">0</span>, <span class="at">favorable =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Hurwicz"

$alfa
[1] 0

$metodo
[1] "favorable"

$tablaX
   e1 e2  e3
d1 90 45 -10
d2 70 55  15
d3 40 35  22

$ValorAlternativas
 d1  d2  d3 
-10  15  22 

$ValorOptimo
[1] 22

$AlternativaOptima
d3 
 3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Hurwicz</span>(tb01a, <span class="at">alfa =</span> <span class="fl">0.4</span>, <span class="at">favorable =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Hurwicz"

$alfa
[1] 0.4

$metodo
[1] "favorable"

$tablaX
   e1 e2  e3
d1 90 45 -10
d2 70 55  15
d3 40 35  22

$ValorAlternativas
  d1   d2   d3 
30.0 37.0 29.2 

$ValorOptimo
[1] 37

$AlternativaOptima
d2 
 2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Hurwicz</span>(tb01a, <span class="at">alfa =</span> <span class="dv">1</span>, <span class="at">favorable =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Hurwicz"

$alfa
[1] 1

$metodo
[1] "favorable"

$tablaX
   e1 e2  e3
d1 90 45 -10
d2 70 55  15
d3 40 35  22

$ValorAlternativas
d1 d2 d3 
90 70 40 

$ValorOptimo
[1] 90

$AlternativaOptima
d1 
 1 </code></pre>
</div>
</div>
<p>La alternativa 3 es la mejor según el criterio de Hurwicz para α &lt; 0.189, la 2 para 0.189&lt;α&lt;0.556 y la 1 para α&gt;0.556.</p>
<p>para α= 0.189 son óptimas tanto la 3 como la 2 y para α=0.556 la 2 y la 1.</p>
<p>CRITERIO DE SAVAGE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Savage</span>(tb01a,T)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Savage"

$metodo
[1] "favorable"

$tablaX
   e1 e2  e3
d1 90 45 -10
d2 70 55  15
d3 40 35  22

$Mejores
e1 e2 e3 
90 55 22 

$Pesos
   e1 e2 e3
d1  0 10 32
d2 20  0  7
d3 50 20  0

$ValorAlternativas
d1 d2 d3 
32 20 50 

$ValorOptimo
[1] 20

$AlternativaOptima
d2 
 2 </code></pre>
</div>
</div>
<p>La alternativa 2 es la mejor según el criterio de Savage.</p>
<p>CRITERIO DE LAPLACE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Laplace</span>(tb01a, <span class="at">favorable =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Laplace"

$metodo
[1] "favorable"

$tablaX
   e1 e2  e3
d1 90 45 -10
d2 70 55  15
d3 40 35  22

$ValorAlternativas
      d1       d2       d3 
41.66667 46.66667 32.33333 

$ValorOptimo
[1] 46.66667

$AlternativaOptima
d2 
 2 </code></pre>
</div>
</div>
<p>La alternativa 2 es la mejor según el criterio de Laplace.</p>
<p>CRITERIO DEL PUNTO IDEAL</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.PuntoIdeal</span>(tb01a, <span class="at">favorable =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Punto Ideal"

$metodo
[1] "favorable"

$tablaX
   e1 e2  e3
d1 90 45 -10
d2 70 55  15
d3 40 35  22

$Mejores
e1 e2 e3 
90 55 22 

$ValorAlternativas
      d1       d2       d3 
33.52611 21.18962 53.85165 

$ValorOptimo
[1] 21.18962

$AlternativaOptima
d2 
 2 </code></pre>
</div>
</div>
<p>La alternativa 2 es la mejor según el criterio del punto ideal</p>
</section>
<section id="situación-desfavorable" class="level4">
<h4 class="anchored" data-anchor-id="situación-desfavorable">Situación desfavorable</h4>
<p>Definiendo la tabla de decision</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>tb01b<span class="ot">=</span><span class="fu">crea.tablaX</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">90</span>, <span class="sc">-</span><span class="dv">45</span>, <span class="dv">10</span>,<span class="sc">-</span><span class="dv">70</span>, <span class="sc">-</span><span class="dv">55</span>, <span class="sc">-</span><span class="dv">15</span>,<span class="sc">-</span><span class="dv">40</span>, <span class="sc">-</span><span class="dv">35</span>, <span class="sc">-</span><span class="dv">22</span>),<span class="at">numalternativas =</span> <span class="dv">3</span>,<span class="at">numestados =</span> <span class="dv">3</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>tb01b</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    e1  e2  e3
d1 -90 -45  10
d2 -70 -55 -15
d3 -40 -35 -22</code></pre>
</div>
</div>
<p>Aplico los métodos de incertidumbre</p>
<p>1) CRITERIO DE WALD</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Wald</span>(tb01b, <span class="at">favorable =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Wald"

$metodo
[1] "desfavorable"

$tablaX
    e1  e2  e3
d1 -90 -45  10
d2 -70 -55 -15
d3 -40 -35 -22

$ValorAlternativas
 d1  d2  d3 
 10 -15 -22 

$ValorOptimo
[1] -22

$AlternativaOptima
d3 
 3 </code></pre>
</div>
</div>
<p>La alternativa 3 es la mejor según el criterio de Wald.</p>
<p>CRITERIO OPTIMISTA</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Optimista</span>(tb01b, <span class="at">favorable =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Optimista"

$metodo
[1] "desfavorable"

$tablaX
    e1  e2  e3
d1 -90 -45  10
d2 -70 -55 -15
d3 -40 -35 -22

$ValorAlternativas
 d1  d2  d3 
-90 -70 -40 

$ValorOptimo
[1] -90

$AlternativaOptima
d1 
 1 </code></pre>
</div>
</div>
<p>La alternativa 1 es la mejor según el criterio optimista.</p>
<p>CRITERIO DE HURWICZ</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dibuja.criterio.Hurwicz</span>(tb01b, <span class="at">favorable =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Resoluciones_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dibuja.criterio.Hurwicz_Intervalos</span>(tb01b, <span class="at">favorable =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Resoluciones_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$AltOptimas
[1] 3 2 1

$PuntosDeCorte
[1] 0.189 0.556

$IntervalosAlfa
           Intervalo           Alternativa
Soluciones "( 0 , 0.189 )"     "3"        
           "( 0.189 , 0.556 )" "2"        
           "( 0.556 , 1 )"     "1"        </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Hurwicz</span>(tb01b, <span class="at">alfa =</span> <span class="dv">0</span>, <span class="at">favorable =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Hurwicz"

$alfa
[1] 0

$metodo
[1] "desfavorable"

$tablaX
    e1  e2  e3
d1 -90 -45  10
d2 -70 -55 -15
d3 -40 -35 -22

$ValorAlternativas
 d1  d2  d3 
 10 -15 -22 

$ValorOptimo
[1] -22

$AlternativaOptima
d3 
 3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Hurwicz</span>(tb01b, <span class="at">alfa =</span> <span class="fl">0.4</span>, <span class="at">favorable =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Hurwicz"

$alfa
[1] 0.4

$metodo
[1] "desfavorable"

$tablaX
    e1  e2  e3
d1 -90 -45  10
d2 -70 -55 -15
d3 -40 -35 -22

$ValorAlternativas
   d1    d2    d3 
-30.0 -37.0 -29.2 

$ValorOptimo
[1] -37

$AlternativaOptima
d2 
 2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Hurwicz</span>(tb01b, <span class="at">alfa =</span> <span class="dv">1</span>, <span class="at">favorable =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Hurwicz"

$alfa
[1] 1

$metodo
[1] "desfavorable"

$tablaX
    e1  e2  e3
d1 -90 -45  10
d2 -70 -55 -15
d3 -40 -35 -22

$ValorAlternativas
 d1  d2  d3 
-90 -70 -40 

$ValorOptimo
[1] -90

$AlternativaOptima
d1 
 1 </code></pre>
</div>
</div>
<p>La alternativa 3 es la mejor según el criterio de Hurwicz para α &lt; 0.189, la 2 para 0.189&lt;α&lt;0.556 y la 1 para α&gt;0.556.</p>
<p>para α = 0.189 son óptimas tanto la 3 como la 2 y para α=0.556 la 2 y la 1.</p>
<p>CRITERIO DE SAVAGE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Savage</span>(tb01b,<span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Savage"

$metodo
[1] "desfavorable"

$tablaX
    e1  e2  e3
d1 -90 -45  10
d2 -70 -55 -15
d3 -40 -35 -22

$Mejores
 e1  e2  e3 
-90 -55 -22 

$Pesos
   e1 e2 e3
d1  0 10 32
d2 20  0  7
d3 50 20  0

$ValorAlternativas
d1 d2 d3 
32 20 50 

$ValorOptimo
[1] 20

$AlternativaOptima
d2 
 2 </code></pre>
</div>
</div>
<p>La alternativa 2 es la mejor según el criterio de Savage.</p>
<p>CRITERIO DE LAPLACE</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Laplace</span>(tb01b, <span class="at">favorable =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Laplace"

$metodo
[1] "desfavorable"

$tablaX
    e1  e2  e3
d1 -90 -45  10
d2 -70 -55 -15
d3 -40 -35 -22

$ValorAlternativas
       d1        d2        d3 
-41.66667 -46.66667 -32.33333 

$ValorOptimo
[1] -46.66667

$AlternativaOptima
d2 
 2 </code></pre>
</div>
</div>
<p>La alternativa 2 es la mejor según el criterio de Laplace.</p>
<p>CRITERIO DEL PUNTO IDEAL</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.PuntoIdeal</span>(tb01b, <span class="at">favorable =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$criterio
[1] "Punto Ideal"

$metodo
[1] "desfavorable"

$tablaX
    e1  e2  e3
d1 -90 -45  10
d2 -70 -55 -15
d3 -40 -35 -22

$Mejores
 e1  e2  e3 
-90 -55 -22 

$ValorAlternativas
      d1       d2       d3 
33.52611 21.18962 53.85165 

$ValorOptimo
[1] 21.18962

$AlternativaOptima
d2 
 2 </code></pre>
</div>
</div>
<p>La alternativa 2 es la mejor según el criterio del punto ideal</p>
</section>
</section>
<section id="conclusión" class="level3">
<h3 class="anchored" data-anchor-id="conclusión">Conclusión</h3>
<p>En situación favorable y desfavorable mismos resultados.</p>
<p>Tres criterios (Savage, Laplace, Punto ideal) favorecen D2; los criterios que extreman la actitud (Wald y Optimista) empujan hacia D3 (muy pesimista) o D1 (muy optimista). El criterio de Hurwicz depiende de <span class="math inline">\(\alpha\)</span>.</p>
<p>Entonces:</p>
<ul>
<li><p>en general D2 es la opción optima</p></li>
<li><p>Si el decisor es muy pesimista D3</p></li>
<li><p>Si es muy optimista D1</p></li>
</ul>
</section>
</section>
<section id="problema-2-restaurante-italiano-y-elección-del-menú" class="level2">
<h2 class="anchored" data-anchor-id="problema-2-restaurante-italiano-y-elección-del-menú">Problema 2 – Restaurante italiano y elección del menú</h2>
<p>Un&nbsp;restaurante italiano&nbsp;debe decidir qué&nbsp;nuevo plato principal&nbsp;incluir en el menú de la próxima temporada. Las alternativas son:</p>
<ul>
<li><p><strong>E1:</strong>&nbsp;Lasagna vegetariana con verduras de temporada</p></li>
<li><p><strong>E2:</strong>&nbsp;Risotto ai frutti di mare</p></li>
<li><p><strong>E3:</strong>&nbsp;Ossobuco alla milanese con risotto a la milanesa</p></li>
</ul>
<p>El exito del plato depende de la preferencia de los clientes, es decir, de los&nbsp;<strong>estados de la naturaleza</strong>:</p>
<ul>
<li><p><strong>S1:</strong>&nbsp;Alta demanda de platos saludables y vegetarianos</p></li>
<li><p><strong>S2:</strong>&nbsp;Preferencias equilibradas entre distintas opciones</p></li>
<li><p><strong>S3:</strong>&nbsp;Mayor inclinación hacia la tradición italiana clásica</p></li>
</ul>
<p>El restaurante estima los&nbsp;beneficios esperados (en miles de €)&nbsp;de la siguiente form</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>S1</th>
<th>S2</th>
<th>S3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>E1</td>
<td>80</td>
<td>50</td>
<td>20</td>
</tr>
<tr class="even">
<td>E2</td>
<td>70</td>
<td>60</td>
<td>40</td>
</tr>
<tr class="odd">
<td>E3</td>
<td>30</td>
<td>55</td>
<td>90</td>
</tr>
</tbody>
</table>
<p>Determinar cuál es la mejor decisión para el restaurante aplicando la función R que devuelve la resolución de todos los métodos en una única tabla</p>
<section id="resolución-1" class="level3">
<h3 class="anchored" data-anchor-id="resolución-1">Resolución</h3>
<p><strong>Planteamento</strong></p>
<ul>
<li><p>Un decisor.</p></li>
<li><p>Modelo de beneficios (favorables).</p></li>
<li><p>Alternativas:</p>
<ul>
<li><p><strong>E1:</strong>&nbsp;Lasagna vegetariana con verduras de temporada</p></li>
<li><p><strong>E2:</strong>&nbsp;Risotto ai frutti di mare</p></li>
<li><p><strong>E3:</strong>&nbsp;Ossobuco alla milanese con risotto a la milanesa</p></li>
</ul></li>
<li><p>Estados de la naturaleza:</p>
<ul>
<li><p><strong>S1:</strong>&nbsp;Alta demanda de platos saludables y vegetarianos</p></li>
<li><p><strong>S2:</strong>&nbsp;Preferencias equilibradas entre distintas opciones</p></li>
<li><p><strong>S3:</strong>&nbsp;Mayor inclinación hacia la tradición italiana clásica</p></li>
</ul></li>
</ul>
<p><strong>Valoraciones (beneficios netos en miles de €):</strong></p>
<ul>
<li><p><strong>Estado S1:</strong></p>
<ul>
<li>x₁,₁ = 120 − 40 = 80<br>
</li>
<li>x₂,₁ = 110 − 40 = 70<br>
</li>
<li>x₃,₁ = 70 − 40 = 30</li>
</ul></li>
<li><p><strong>Estado S2:</strong></p>
<ul>
<li>x₁,₂ = 90 − 40 = 50<br>
</li>
<li>x₂,₂ = 100 − 40 = 60<br>
</li>
<li>x₃,₂ = 95 − 40 = 55</li>
</ul></li>
<li><p><strong>Estado S3:</strong></p>
<ul>
<li>x₁,₃ = 60 − 40 = 20<br>
</li>
<li>x₂,₃ = 80 − 40 = 40<br>
</li>
<li>x₃,₃ = 130 − 40 = 90</li>
</ul></li>
<li><p>Tabla de valoraciones:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>S1</th>
<th>S2</th>
<th>S3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>E1</td>
<td>80</td>
<td>50</td>
<td>20</td>
</tr>
<tr class="even">
<td>E2</td>
<td>70</td>
<td>60</td>
<td>40</td>
</tr>
<tr class="odd">
<td>E3</td>
<td>30</td>
<td>55</td>
<td>90</td>
</tr>
</tbody>
</table></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>tb01c<span class="ot">=</span><span class="fu">crea.tablaX</span>(<span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">50</span>, <span class="dv">20</span>,<span class="dv">70</span>, <span class="dv">60</span>, <span class="dv">40</span>, <span class="dv">30</span>, <span class="dv">55</span>, <span class="dv">90</span>),<span class="at">numalternativas =</span> <span class="dv">3</span>,<span class="at">numestados =</span> <span class="dv">3</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Añado nombres a las filas y columnas</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(tb01c)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Lasagna"</span>,<span class="st">"Ristto marisco"</span>,<span class="st">"Ossobuco Milanés"</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tb01c)<span class="ot">=</span><span class="fu">c</span>(<span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>tb01c</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 S1 S2 S3
Lasagna          80 50 20
Ristto marisco   70 60 40
Ossobuco Milanés 30 55 90</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resuelvo utilizando la función 'criterio.Todos'</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">criterio.Todos</span>(tb01c, <span class="at">favorable =</span> <span class="cn">TRUE</span>, <span class="at">alfa =</span> <span class="fl">0.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 S1 S2 S3           Wald        Optimista          Hurwicz
Lasagna          80 50 20             20               80               50
Ristto marisco   70 60 40             40               70               55
Ossobuco Milanés 30 55 90             30               90               60
iAlt.Opt (fav.)  -- -- -- Ristto marisco Ossobuco Milanés Ossobuco Milanés
                                          Savage          Laplace
Lasagna                                       70            50.00
Ristto marisco                                50            56.67
Ossobuco Milanés                              50            58.33
iAlt.Opt (fav.)  Ristto marisco,Ossobuco Milanés Ossobuco Milanés
                      Punto Ideal     Veces Optima
Lasagna                     70.71                0
Ristto marisco              50.99                2
Ossobuco Milanés            50.25                5
iAlt.Opt (fav.)  Ossobuco Milanés Ossobuco Milanés</code></pre>
</div>
</div>
<p>Según los resultados:</p>
<ul>
<li><p>Criterio de Wald: mejor Risotto de marisco.</p></li>
<li><p>Criterio optimista, del punto ideal, de Laplace y de Hurwicz (α = 0.5): mejor Ossobuco a la milanesa. (Nota: α no estaba indicado en el enunciado, aquí se fija α = 0.5 para el ejemplo).</p></li>
<li><p>Criterio de Savage: Risotto de marisco y Ossobuco a la milanesa son óptimos (empate).</p></li>
</ul>
<p>Observamos el comportamiento del criterio de Hurwicz en función de α:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estudio la mejor alternativa para cada valor de α</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dibuja.criterio.Hurwicz</span>(tb01c, <span class="at">favorable =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Resoluciones_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dibuja.criterio.Hurwicz_Intervalos</span>(tb01c, <span class="at">favorable =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Resoluciones_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>$AltOptimas
[1] 2 3

$PuntosDeCorte
[1] 0.333

$IntervalosAlfa
     Intervalo       Alternativa
[1,] "( 0 , 0.333 )" "2"        
[2,] "( 0.333 , 1 )" "3"        </code></pre>
</div>
</div>
<p>Según el criterio de Hurwicz,</p>
<ul>
<li><p>Risotto de marisco es la mejor alternativa para α &lt; 0.333,</p></li>
<li><p>Ossobuco a la milanesa es la mejor para α &gt; 0.333,</p></li>
<li><p>y para α = 0.333 ambas alternativas son óptimas.</p></li>
</ul>
</section>
<section id="conclusión-1" class="level3">
<h3 class="anchored" data-anchor-id="conclusión-1">Conclusión</h3>
<p>Utilizando el criterio de todos y suponiendo que <span class="math inline">\(\alpha \geq 0.333\)</span>, se observa que en 5 de los 6 métodos la mejor opción es el Ossobuco a la milanesa, mientras que la alternativa Risotto de marisco resulta mejor según el criterio de Wald, el criterio de Savage (empate con el Ossobuco) y el criterio de Hurwicz para <span class="math inline">\(\alpha \leq 0.333\)</span> (empate en <span class="math inline">\(\alpha = 0.333\)</span> con).</p>
<p>Resultado final:</p>
<p>En general, considerando la mayoría de los criterios y un valor habitual de <span class="math inline">\(\alpha\)</span> (0.333 o superior), la mejor alternativa global es el Ossobuco a la milanesa.</p>
<p>Si el restaurante fuera pesimista, la alternativa Risotto de marisco sería raccomandable</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>