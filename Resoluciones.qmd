---
title: "resoluciones"
lang: es
format:
  html:
    toc: true
  typst:
    toc: true
    pdf-engine: typst
    papersize: a4
    margin:  {x: 1.75cm, y: 1.5cm}
execute:
  cache: true
editor: 
  markdown: 
    wrap: 72
---

## Problema 1
 
Aplicar los criterios de decisión bajo incertidumbre a el problema cuya tabla de decisión es la siguiente:

**favorable**

|     | E1  | E2  | E3  |
|-----|-----|-----|-----|
| D1  | 90  | 45  | -10 |
| D2  | 70  | 55  | 15  |
| D3  | 40  | 35  | 22  |

**desfavorable**

|     | E1  | E2  | E3  |
|-----|-----|-----|-----|
| D1  | -90 | -45 | 10  |
| D2  | -70 | -55 | -15 |
| D3  | -40 | -35 | -22 |

resuelverlo con cada uno de los métodos o funciones individuales de incertidumbre por separado (tanto en situación favorable como desfavorable)

### Resolución


```{r}
source("teoriadecision_funciones_incertidumbre.R")
```

#### Situación favorable

Definimos la tabla de decision

```{r}
tb01a=crea.tablaX(c(90, 45, -10,70, 55, 15,40, 35, 22),numalternativas = 3,numestados = 3)
tb01a
```

Aplico los métodos de incertidumbre

1\) CRITERIO DE WALD

```{r}
criterio.Wald(tb01a, favorable = TRUE)
```

La alternativa 3 es la mejor según el criterio de Wald.

CRITERIO OPTIMISTA

```{r}
criterio.Optimista(tb01a, favorable = TRUE)
```

La alternativa 1 es la mejor según el criterio optimista.

CRITERIO DE HURWICZ

```{r}
dibuja.criterio.Hurwicz(tb01a, favorable = TRUE)
dibuja.criterio.Hurwicz_Intervalos(tb01a, favorable = TRUE)
```

```{r}
criterio.Hurwicz(tb01a, alfa = 0, favorable = TRUE)
criterio.Hurwicz(tb01a, alfa = 0.4, favorable = TRUE)
criterio.Hurwicz(tb01a, alfa = 1, favorable = TRUE)
```

La alternativa 3 es la mejor según el criterio de Hurwicz para α \< 0.189, la 2 para 0.189\<α\<0.556 y la 1 para α\>0.556.

para α= 0.189 son óptimas tanto la 3 como la 2 y para α=0.556 la 2 y la 1.

CRITERIO DE SAVAGE

```{r}
criterio.Savage(tb01a,T)
```

La alternativa 2 es la mejor según el criterio de Savage.

CRITERIO DE LAPLACE

```{r}

criterio.Laplace(tb01a, favorable = TRUE)
```

La alternativa 2 es la mejor según el criterio de Laplace.

CRITERIO DEL PUNTO IDEAL

```{r}

criterio.PuntoIdeal(tb01a, favorable = TRUE)
```

La alternativa 2 es la mejor según el criterio del punto ideal

#### Situación desfavorable

Definiendo la tabla de decision

```{r}
tb01b=crea.tablaX(c(-90, -45, 10,-70, -55, -15,-40, -35, -22),numalternativas = 3,numestados = 3)
tb01b
```

Aplico los métodos de incertidumbre

1\) CRITERIO DE WALD

```{r}
criterio.Wald(tb01b, favorable = FALSE)
```

La alternativa 3 es la mejor según el criterio de Wald.

CRITERIO OPTIMISTA

```{r}
criterio.Optimista(tb01b, favorable = FALSE)
```

La alternativa 1 es la mejor según el criterio optimista.

CRITERIO DE HURWICZ

```{r}
dibuja.criterio.Hurwicz(tb01b, favorable = FALSE)
dibuja.criterio.Hurwicz_Intervalos(tb01b, favorable = FALSE)
```

```{r}
  
criterio.Hurwicz(tb01b, alfa = 0, favorable = FALSE)
criterio.Hurwicz(tb01b, alfa = 0.4, favorable = FALSE)
criterio.Hurwicz(tb01b, alfa = 1, favorable = FALSE)
```

La alternativa 3 es la mejor según el criterio de Hurwicz para α \< 0.189, la 2 para 0.189\<α\<0.556 y la 1 para α\>0.556.

para α = 0.189 son óptimas tanto la 3 como la 2 y para α=0.556 la 2 y la 1.

CRITERIO DE SAVAGE

```{r}
criterio.Savage(tb01b,FALSE)
```

La alternativa 2 es la mejor según el criterio de Savage.

CRITERIO DE LAPLACE

```{r}

criterio.Laplace(tb01b, favorable = FALSE)
```

La alternativa 2 es la mejor según el criterio de Laplace.

CRITERIO DEL PUNTO IDEAL

```{r}

criterio.PuntoIdeal(tb01b, favorable = FALSE)
```

La alternativa 2 es la mejor según el criterio del punto ideal

### Conclusión

En situación favorable y desfavorable mismos resultados.

Tres criterios (Savage, Laplace, Punto ideal) favorecen D2; los criterios que extreman la actitud (Wald y Optimista) empujan hacia D3 (muy pesimista) o D1 (muy optimista). El criterio de Hurwicz depiende de $\alpha$.

Entonces:

-   en general D2 es la opción optima

-   Si el decisor es muy pesimista D3

-   Si es muy optimista D1

## Problema 2 – Restaurante italiano y elección del menú

Un restaurante italiano debe decidir qué nuevo plato principal incluir en el menú de la próxima temporada. Las alternativas son:

-   **E1:** Lasagna vegetariana con verduras de temporada

-   **E2:** Risotto ai frutti di mare

-   **E3:** Ossobuco alla milanese con risotto a la milanesa

El exito del plato depende de la preferencia de los clientes, es decir, de los **estados de la naturaleza**:

-   **S1:** Alta demanda de platos saludables y vegetarianos

-   **S2:** Preferencias equilibradas entre distintas opciones

-   **S3:** Mayor inclinación hacia la tradición italiana clásica

El restaurante estima los beneficios esperados (en miles de €) de la siguiente form

|     | S1  | S2  | S3  |
|-----|-----|-----|-----|
| E1  | 80  | 50  | 20  |
| E2  | 70  | 60  | 40  |
| E3  | 30  | 55  | 90  |

Determinar cuál es la mejor decisión para el restaurante aplicando la función R que devuelve la resolución de todos los métodos en una única tabla

### Resolución

**Planteamento**	

-   Un decisor.

-   Modelo de beneficios (favorables).

-   Alternativas:

    -   **E1:** Lasagna vegetariana con verduras de temporada

    -   **E2:** Risotto ai frutti di mare

    -   **E3:** Ossobuco alla milanese con risotto a la milanesa

-   Estados de la naturaleza:

    -   **S1:** Alta demanda de platos saludables y vegetarianos

    -   **S2:** Preferencias equilibradas entre distintas opciones

    -   **S3:** Mayor inclinación hacia la tradición italiana clásica
    
**Valoraciones (beneficios netos en miles de €):**

- **Estado S1:**  
  - x₁,₁ = 120 − 40 = 80  
  - x₂,₁ = 110 − 40 = 70  
  - x₃,₁ = 70 − 40 = 30  

- **Estado S2:**  
  - x₁,₂ = 90 − 40 = 50  
  - x₂,₂ = 100 − 40 = 60  
  - x₃,₂ = 95 − 40 = 55  

- **Estado S3:**  
  - x₁,₃ = 60 − 40 = 20  
  - x₂,₃ = 80 − 40 = 40  
  - x₃,₃ = 130 − 40 = 90  

-   Tabla de valoraciones:

    |     | S1  | S2  | S3  |
    |-----|-----|-----|-----|
    | E1  | 80  | 50  | 20  |
    | E2  | 70  | 60  | 40  |
    | E3  | 30  | 55  | 90  |

```{r}

tb01c=crea.tablaX(c(80, 50, 20,70, 60, 40, 30, 55, 90),numalternativas = 3,numestados = 3)

#Añado nombres a las filas y columnas
rownames(tb01c)=c("Lasagna","Ristto marisco","Ossobuco Milanés")
colnames(tb01c)=c("S1", "S2", "S3")
tb01c
```

```{r}
# Resuelvo utilizando la función 'criterio.Todos'
criterio.Todos(tb01c, favorable = TRUE, alfa = 0.5)
```

Según los resultados:

-   Criterio de Wald: mejor Risotto de marisco.

-   Criterio optimista, del punto ideal, de Laplace y de Hurwicz (α = 0.5): mejor Ossobuco a la milanesa. (Nota: α no estaba indicado en el enunciado, aquí se fija α = 0.5 para el ejemplo).

-   Criterio de Savage: Risotto de marisco y Ossobuco a la milanesa son óptimos (empate).

Observamos el comportamiento del criterio de Hurwicz en función de α:

```{r}
# Estudio la mejor alternativa para cada valor de α
dibuja.criterio.Hurwicz(tb01c, favorable = TRUE)
dibuja.criterio.Hurwicz_Intervalos(tb01c, favorable = TRUE)
```

Según el criterio de Hurwicz,

-   Risotto de marisco es la mejor alternativa para α \< 0.333,

-   Ossobuco a la milanesa es la mejor para α \> 0.333,

-   y para α = 0.333 ambas alternativas son óptimas.

### Conclusión

Utilizando el criterio de todos y suponiendo que $\alpha \geq 0.333$, se observa que en 5 de los 6 métodos la mejor opción es el Ossobuco a la milanesa, mientras que la alternativa Risotto de marisco resulta mejor según el criterio de Wald, el criterio de Savage (empate con el Ossobuco) y el criterio de Hurwicz para $\alpha \leq 0.333$ (empate en $\alpha = 0.333$ con).

Resultado final:

En general, considerando la mayoría de los criterios y un valor habitual de $\alpha$ (0.333 o superior), la mejor alternativa global es el Ossobuco a la milanesa.

Si el restaurante fuera pesimista, la alternativa Risotto de marisco sería raccomandable
